<div>
  <div>
    <h3>Search Inventory</h3>
  </div>

  <div>
    <h4>Environment</h4>
    <div class="filters-header">
      <div class="filter">
        <app-env-override-field></app-env-override-field>
      </div>
    </div>
  </div>

  <hr>
  <div class="filters">
    <h4>Filters</h4>
    <strong>Only Vendor ID is required!</strong>
    <div class="filters-header">
      <div class="filter">
        <div class="d-flex">
          <app-input
            placeholder="Vendor ID"
            [(ngModel)]="query.vendorId"
            (onChangeEnd)="reloadFilters();"></app-input>
          <button
            (click)="pickVendorIdFromEnv()"
            class="btn btn-sm btn-outline-warning ms-1">Pick
          </button>
        </div>
        <small class="c-pointer" (click)="addCurrentVendorId()">Use current</small>
      </div>
      <div class="filter">
        <div class="d-flex">
          <app-input
            placeholder="DDC"
            [clearOnChangeEnd]="true"
            (onChangeEnd)="addDDC($event)"></app-input>
          <button
            (click)="pickDDCFromAccount()"
            class="btn btn-sm btn-outline-warning ms-1">Pick
          </button>
        </div>
        <div
          class="d-flex justify-content-between align-items-center"
          *ngFor="let ddc of query.deliveryCenters; let ind = index">
          <span>
            <app-tooltip-span
              [trimDisplayTextChars]="15"
              [tooltipText]="ddc"
              [enableCopy]="true"
              [displayText]="ddc"></app-tooltip-span>
          </span>

          <strong>
            <i (click)="removeDDC(ind)" class="fa fa-x"></i>
          </strong>
        </div>
      </div>
      <div class="filter">
        <div class="d-flex">
          <app-input
            placeholder="Vendor Acc ID"
            [(ngModel)]="query.vendorAccountId"
            (onChangeEnd)="reloadFilters()"></app-input>
          <button
            (click)="pickVendorAccountIdFromAccount()"
            class="btn btn-sm btn-outline-warning ms-1">Pick
          </button>
        </div>
      </div>

      <div class="filter">
        <div>
          <app-input
            placeholder="Item Id (Vendor | SKU)"
            [clearOnChangeEnd]="true"
            (onChangeEnd)="addVendorItemId($event)"></app-input>
        </div>
        <div
          class="d-flex justify-content-between align-items-center"
          *ngFor="let vid of query.vendorItemIds; let ind = index">
          <span>
            <app-tooltip-span
              [trimDisplayTextChars]="15"
              [tooltipText]="vid"
              [enableCopy]="true"
              [displayText]="vid"></app-tooltip-span>
          </span>

          <strong>
            <i (click)="removeVendorItemId(ind)" class="fa fa-x"></i>
          </strong>
        </div>
      </div>
      <div class="filter">
        <button (click)="resetFilters()" class="btn btn-outline-danger">Reset</button>
      </div>
    </div>
  </div>

  <hr>

  <div class="main">
    <div *ngIf="fullResponse && !fullResponse.isSuccess">
      <div class="alert alert-warning d-flex justify-content-between">
        <p>Request concluded with failure!</p>
        <button class="btn btn-outline-dark" (click)="openResponseDetailsDialog()">Show Details</button>
      </div>
    </div>
    <p class="text-primary">Showing all {{ inventories.length }} Inventories from {{ ddcs.length }} DDCs</p>
    <div>
      <div class="text-end">
        <button (click)="showRawResponse()" class="btn btn-outline-dark">Show Raw Response</button>
        <button (click)="showAllInventories()" class="ms-1 btn btn-outline-info">Show All Inventories</button>
        <button (click)="showAllDDCs()" class="ms-1 btn btn-outline-primary">Show All DDCs</button>
      </div>
      <hr>

      <table class="table table-striped table-hover">
        <thead>
        <tr>
          <th scope="col">DDC</th>
          <th scope="col">Item ID / QTY</th>
          <th scope="col">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let inventory of inventories">
          <th scope="row">
            <div><small>
              <app-tooltip-span
                [enableCopy]="true"
                [tooltipText]="inventory.ddc"
                [displayText]="inventory.ddc"
                [trimDisplayTextChars]="25"></app-tooltip-span>
            </small></div>
          </th>
          <td>
            <div>
              <app-tooltip-span
                [enableCopy]="true"
                [tooltipText]="inventory.vendorItemId"
                [displayText]="inventory.vendorItemId"
                [trimDisplayTextChars]="25"></app-tooltip-span>
            </div>
            <div>{{ inventory.quantity }}</div>
          </td>
          <td style="vertical-align: middle">
            <div class="d-flex justify-content-around align-items-center">
              <button class="btn btn-outline-success" (click)="openDetailsDialog(inventory)">View Details</button>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
